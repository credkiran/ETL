6. Manually run the following script for to generate Cashflow for interest and redemption :

	DELETE FROM SECUMAST WHERE TYPECODE='FRAMAIN';
	INSERT INTO SECUMAST (TYPECODE, TYPEDESC, AI_DAY_COUNT, CF_DAY_COUNT, GRP, USER_TYPECODE, ASSET_CLASS_CODE, AUTHORIZATION_STATUS, AUTHORIZEDBY, CASHFLOW_CALC_METHOD, AUTHORIZATIONDATETIME, IS_DISCOUNTED, IS_REGULAR, IS_IRREGULAR_CASHFLOW, IS_IRREGULAR_REDEMPTION, REPORTINGASSETCLASS, RESIDUAL_MAT_VAL_AMORT, OVERWRITE_MTMPRICE, SL_AMORTIZATION_BASIS, EXCLUDE_MM_YIELD_PRICE, IRF_ELIGIBLE)
	VALUES ('FRAMAIN', 'FORWARD RATE AGREEMENT MAIN', NULL, NULL, NULL, NULL, 'IRD', 0, NULL, 'METHOD1', NULL, 0, 1, 0, 0, NULL, '1', 'T', NULL, 0, '0');

	DELETE FROM if_premium_cashflows WHERE cashflow_type IN ('INTEREST','REDEMPTION','REDEMPTION - PARTIAL');  
	INSERT INTO if_premium_cashflows 
	SELECT Last_Day(se.enddate),se.portcode,Upper(EVENT),Sum(AMOUNT),0 utilised_amount FROM 
	( 

	SELECT portcode,PORTFOLIO, SECURITYSYMBOL, STARTDATE, ENDDATE, Sum(AMOUNT) as AMOUNT, EVENT, AMOUNTTYPE, CURRENCY, EVENTTYPE, RECEIVABLEDATE, INTEREST, EXERCISED, EXERCISEDATE, MATYEAR, MATDATE, GUID, REMARKS FROM ( SELECT portmast.portcode,PORTMAST.PORTNAME as PORTFOLIO,upper(OutStandingSecurities.SECURITYSYMBOL) as SECURITYSYMBOL,Decode(GLOBAL_SECURITY.ASSET_CLASS_CODE||type,'DEPORD',Decode(SECURITYEVENTS.EVENTDESCRIPTION,'REDEMPTION',GLOBAL_SECURITY.ISSDATE,SECURITYEVENTS.NOTICEDATE),Decode(GLOBAL_SECURITY.COUPYEAR,0,GLOBAL_SECURITY.ISSDATE,SECURITYEVENTS.NOTICEDATE)) as startdate,Decode(GLOBAL_SECURITY.ASSET_CLASS_CODE||type,'DEPORD',Decode(SECURITYEVENTS.EVENTDESCRIPTION,'REDEMPTION',GLOBAL_SECURITY.MATDATE,SECURITYEVENTS.STARTDATE),Decode(GLOBAL_SECURITY.COUPYEAR,0,GLOBAL_SECURITY.MATDATE,SECURITYEVENTS.STARTDATE)) as ENDDATE,Decode(upper(TYPE||SECURITYEVENTS.EVENTDESCRIPTION),'RDREDEMPTION PAYABLE',(SELECT amount FROM securityentry WHERE transaction_type_code IN (124) AND secacccode=22 AND securitysymbol=OutStandingSecurities.securitysymbol)*Decode(SECURITYEVENTS.quantity,0,1,'',1),'RDINTEREST',(SELECT QUANTITY FROM securityentry WHERE transaction_type_code IN (124) AND secacccode=22 AND securitysymbol=OutStandingSecurities.securitysymbol)*(SECURITYEVENTS.AMOUNT),OutStandingSecurities.QUANTITY*(SECURITYEVENTS.AMOUNT) )as AMOUNT, upper(SECURITYEVENTS.EVENTDESCRIPTION) as EVENT,UPPER(SECURITYEVENTS.AMOUNTTYPE) as AMOUNTTYPE,	SECURITYEVENTS.CURRENCYSYMBOL as CURRENCY,UPPER(SECURITYEVENTS.EVENTTYPE) as EVENTTYPE,Decode(GLOBAL_SECURITY.ASSET_CLASS_CODE||type,'DEPORD',Decode(SECURITYEVENTS.EVENTDESCRIPTION,'REDEMPTION',GLOBAL_SECURITY.MATDATE,SECURITYEVENTS.ENDDATE),Decode(GLOBAL_SECURITY.COUPYEAR,0,GLOBAL_SECURITY.MATDATE,SECURITYEVENTS.ENDDATE)) as RECEIVABLEDATE,GLOBAL_SECURITY.INTEREST as INTEREST, case when (upper(SECURITYEVENTS.EVENTDESCRIPTION) <>'PUT OPTION' and upper(SECURITYEVENTS.EVENTDESCRIPTION) <>'CALL OPTION') and  ((SELECT Count(SECURITYSYMBOL) FROM TRANSACT t WHERE SECURITYSYMBOL = OutStandingSecurities.SECURITYSYMBOL AND t.TRANSACTION_TYPE_CODE IN (47 ,121) AND  t.trans_date=SECURITYEVENTS.EXERCISEDATE and round((OutStandingSecurities.QUANTITY*(SECURITYEVENTS.AMOUNT))- (t.first_leg_amount),0)=0)   > 0 ) THEN  'YES'  when ( upper(SECURITYEVENTS.EVENTDESCRIPTION) <>'PUT OPTION' and upper(SECURITYEVENTS.EVENTDESCRIPTION) <>'CALL OPTION') AND  ((SELECT Count(SECURITYSYMBOL) FROM TRANSACT t WHERE SECURITYSYMBOL = OutStandingSecurities.SECURITYSYMBOL AND t.TRANSACTION_TYPE_CODE IN (47 ,121) AND  t.trans_date=SECURITYEVENTS.EXERCISEDATE and round((OutStandingSecurities.QUANTITY*(SECURITYEVENTS.AMOUNT))- (t.first_leg_amount),0)=0) = 0 ) then 'NO' else DECODE(SECURITYEVENTS.EXERCISED,0,'NO','YES') END EXERCISED, Decode(GLOBAL_SECURITY.ASSET_CLASS_CODE,'DEPO',Decode(GLOBAL_SECURITY.COUPYEAR,0,GLOBAL_SECURITY.MATDATE,SECURITYEVENTS.EXERCISEDATE), SECURITYEVENTS.EXERCISEDATE) as EXERCISEDATE, GLOBAL_SECURITY.matyear matyear,GLOBAL_SECURITY.matdate matdate , SECURITYEVENTS.GUID GUID, SECURITYEVENTS.REMARKS REMARKS from PORTMAST,SECURITYEVENTS,GLOBAL_SECURITY, (select (SECURITYENTRY.PORTCODE) as PORTCODE,(SECURITYENTRY.SECURITYSYMBOL) as SECURITYSYMBOL, SUM(DEBIT_CREDIT*QUANTITY) QUANTITY,sUM(DEBIT_CREDIT*AMOUNT) AMOUNT from securityentry,global_security where securityentry.securitysymbol=global_security.securitysymbol and securityentry.secacccode In (22 ,Decode(transaction_type_code,120,31,125,31,126,31,127,31,128,31,3,15,2,15,119,15,NULL) ) and to_date(securityentry.settledate,'DD/MM/YYYY') <= to_date('01-01-3100','DD/MM/YYYY') group by portcode ,securityentry.securitysymbol having sum(debit_credit *quantity) > 0) OutStandingSecurities where  outstandingsecurities.portcode = portmast.portcode  and OutStandingSecurities.securitysymbol = securityevents.securitysymbol and securityevents.securitysymbol = global_security.securitysymbol  and global_security.asset_class_Code in ('SLR','NSLR','DEPO','EQ','MF')  and (Decode(GLOBAL_SECURITY.ASSET_CLASS_CODE,'DEPO',DECODE(EVENTDESCRIPTION,'REDEMPTION PAYABLE',TO_DATE(SECURITYEVENTS.STARTDATE,'DD/MM/YYYY'),Decode(GLOBAL_SECURITY.COUPYEAR,0,TO_DATE(GLOBAL_SECURITY.MATDATE,'DD/MM/YYYY'),TO_DATE(SECURITYEVENTS.STARTDATE,'DD/MM/YYYY'))),TO_DATE(SECURITYEVENTS.STARTDATE,'DD/MM/YYYY')) 
	BETWEEN TO_DATE('01-01-1898','DD/MM/YYYY') AND to_date('01-01-3100','DD/MM/YYYY') OR ( ( TO_DATE('01-01-1898','DD/MM/YYYY') BETWEEN TO_DATE(SECURITYEVENTS.STARTDATE,'DD/MM/YYYY') AND TO_DATE(SECURITYEVENTS.ENDDATE,'DD/MM/YYYY') OR TO_DATE('01-01-3100','DD/MM/YYYY') BETWEEN TO_DATE(SECURITYEVENTS.STARTDATE,'DD/MM/YYYY') AND TO_DATE(SECURITYEVENTS.ENDDATE,'DD/MM/YYYY') ) AND (Upper(SECURITYEVENTS.EVENTDESCRIPTION) = 'PUT OPTION' OR Upper(SECURITYEVENTS.EVENTDESCRIPTION) = 'CALL OPTION')) ) AND CASE WHEN (GLOBAL_SECURITY.TYPE='RD' AND GLOBAL_SECURITY.COUPYEAR=0 AND UPPER(EVENTDESCRIPTION)='INTEREST') THEN TRUNC(ENDDATE) ELSE TRUNC(SYSDATE) END =  CASE WHEN (GLOBAL_SECURITY.TYPE='RD' AND UPPER(EVENTDESCRIPTION)='INTEREST') THEN TRUNC(GLOBAL_SECURITY.MATDATE) ELSE TRUNC(SYSDATE) END ) GROUP BY portcode,PORTFOLIO, SECURITYSYMBOL, STARTDATE, ENDDATE,EVENT,AMOUNTTYPE, CURRENCY,EVENTTYPE,RECEIVABLEDATE, INTEREST, EXERCISED, EXERCISEDATE, MATYEAR, MATDATE, GUID, REMARKS order by EVENT,ENDDATE,matyear,SECURITYSYMBOL
	) se WHERE 1=1 
	AND UPPER(EVENT) IN ('INTEREST','REDEMPTION','REDEMPTION - PARTIAL')
	GROUP BY  Last_Day(se.enddate),se.portcode,Upper(EVENT)
	ORDER BY  Last_Day(se.enddate),se.portcode;

	UPDATE if_premium_cashflows SET cashflow_type='REDEMPTION' WHERE cashflow_type='REDEMPTION - PARTIAL'; 
